Source URL: https://developers.google.com/workspace/gmail/postmaster/quickstart/python

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
Switch to English
홈 [https://developers.google.com/?hl=ko]
Google Workspace [https://developers.google.com/workspace?hl=ko]
Gmail [https://developers.google.com/workspace/gmail?hl=ko]
가이드 [https://developers.google.com/workspace/gmail/api/guides?hl=ko]
도움이 되었나요?
의견 보내기
Python 빠른 시작
bookmark_border
이 페이지의 내용
목표 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#objectives]
기본 요건 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#prerequisites]
환경 설정 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#set-up-environment]
API 사용 설정 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#enable_the_api]
OAuth 동의 화면 구성 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#configure_the_oauth_consent_screen]
데스크톱 애플리케이션의 사용자 인증 정보 승인 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#authorize_credentials_for_a_desktop_application]
Google 클라이언트 라이브러리 설치 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#install_the_google_client_library]
샘플 구성 [https://developers.google.com/workspace/gmail/postmaster/quickstart/python?hl=ko#configure_the_sample]
Postmaster Tools API에 요청을 보내는 Python 명령줄 애플리케이션을 만듭니다.
빠른 시작에서는 Google Workspace API를 호출하는 앱을 설정하고 실행하는 방법을 설명합니다. 이 빠른 시작에서는 테스트 환경에 적합한 간소화된 인증 방식을 사용합니다. 프로덕션 환경의 경우 앱에 적합한 액세스 사용자 인증 정보 선택 [https://developers.google.com/workspace/guides/create-credentials?hl=ko#choose_the_access_credential_that_is_right_for_you] 전에 인증 및 승인 [https://developers.google.com/workspace/guides/auth-overview?hl=ko]에 대해 알아보는 것이 좋습니다.
이 빠른 시작에서는 Google Workspace의 권장 API 클라이언트 라이브러리를 사용하여 인증 및 승인 흐름의 일부 세부정보를 처리합니다.
목표
환경을 설정합니다.
클라이언트 라이브러리를 설치합니다.
샘플을 설정합니다.
샘플을 실행합니다.
기본 요건
이 빠른 시작을 실행하려면 다음 기본 요건이 필요합니다.
Python 3.10.7 이상
pip [https://pypi.python.org/pypi/pip] 패키지 관리 도구
Google Cloud 프로젝트 [https://developers.google.com/workspace/guides/create-project?hl=ko].
Gmail이 사용 설정된 Google 계정
환경 설정
이 빠른 시작을 완료하려면 환경을 설정하세요.
API 사용 설정
Google API를 사용하려면 먼저 Google Cloud 프로젝트에서 사용 설정해야 합니다. 단일 Google Cloud 프로젝트에서 하나 이상의 API를 사용 설정할 수 있습니다.
Google Cloud 콘솔에서 Postmaster Tools API를 사용 설정합니다.
API 사용 설정 [https://console.cloud.google.com/flows/enableapi?apiid=gmailpostmastertools.googleapis.com&hl=ko]
OAuth 동의 화면 구성
새 Google Cloud 프로젝트를 사용하여 이 빠른 시작을 완료하는 경우 OAuth 동의 화면을 구성합니다. Cloud 프로젝트에서 이 단계를 이미 완료했다면 다음 섹션으로 건너뜁니다.
Google Cloud 콘솔에서 메뉴 menu > > 브랜딩으로 이동합니다.
브랜딩으로 이동 [https://console.cloud.google.com/auth/branding?hl=ko]
을 이미 구성한 경우 브랜딩 [https://console.cloud.google.com/auth/branding?hl=ko], 잠재고객 [https://console.cloud.google.com/auth/audience?hl=ko], 데이터 액세스 [https://console.cloud.google.com/auth/scopes?hl=ko]에서 다음 OAuth 동의 화면 설정을 구성할 수 있습니다. 아직 구성되지 않음이라는 메시지가 표시되면 시작하기를 클릭합니다.
앱 정보의 앱 이름에 앱 이름을 입력합니다.
사용자 지원 이메일에서 사용자가 동의에 대해 문의할 수 있는 지원 이메일 주소를 선택합니다.
다음을 클릭합니다.
시청자층에서 내부를 선택합니다.
다음을 클릭합니다.
연락처 정보에서 프로젝트 변경사항에 대한 알림을 받을 수 있는 이메일 주소를 입력합니다.
다음을 클릭합니다.
완료에서 Google API 서비스 사용자 데이터 정책 [https://developers.google.com/terms/api-services-user-data-policy?hl=ko]을 검토하고 동의하는 경우 Google API 서비스: 사용자 데이터 정책에 동의합니다를 선택합니다.
계속을 클릭합니다.
만들기를 클릭합니다.
지금은 범위를 추가하지 않아도 됩니다. 향후 Google Workspace 조직 외부에서 사용할 앱을 만들 때는 사용자 유형을 외부로 변경해야 합니다. 그런 다음 앱에 필요한 승인 범위를 추가합니다. 자세한 내용은 OAuth 동의 구성 [https://developers.google.com/workspace/guides/configure-oauth-consent?hl=ko] 가이드를 참고하세요.
데스크톱 애플리케이션의 사용자 인증 정보 승인
최종 사용자를 인증하고 앱에서 사용자 데이터에 액세스하려면 OAuth 2.0 클라이언트 ID를 하나 이상 만들어야 합니다. 클라이언트 ID는 Google OAuth 서버에서 단일 앱을 식별하는 데 사용됩니다. 앱이 여러 플랫폼에서 실행되는 경우 플랫폼별로 별도의 클라이언트 ID를 만들어야 합니다.
Google Cloud 콘솔에서 메뉴 menu > > 클라이언트로 이동합니다.
클라이언트로 이동 [https://console.cloud.google.com/auth/clients?hl=ko]
클라이언트 만들기를 클릭합니다.
애플리케이션 유형 > 데스크톱 앱을 클릭합니다.
이름 필드에 사용자 인증 정보의 이름을 입력합니다. 이 이름은 Google Cloud 콘솔에만 표시됩니다.
만들기를 클릭합니다.
새로 만든 사용자 인증 정보가 'OAuth 2.0 클라이언트 ID' 아래에 표시됩니다.
다운로드한 JSON 파일을 credentials.json로 저장하고 파일을 작업 디렉터리로 이동합니다.
Google 클라이언트 라이브러리 설치
Python용 Google 클라이언트 라이브러리를 설치합니다.
pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib
샘플 구성
작업 디렉터리에 quickstart.py이라는 파일을 만듭니다.
quickstart.py에 다음 코드를 포함합니다.
from __future__ import print_function
import pickle
import os.path
from googleapiclient.discovery import build
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request
from googleapiclient import errors

# If modifying these scopes, delete the file token.pickle.
SCOPES = ['https://www.googleapis.com/auth/postmaster.readonly']

def main():
    """Shows basic usage of the PostmasterTools v1beta1 API.
    Prints the visible domains on user's domain dashboard in https://postmaster.google.com/managedomains.
    """
    creds = None
    # The file token.pickle stores the user's access and refresh tokens, and is
    # created automatically when the authorization flow completes for the first
    # time.
    if os.path.exists('token.pickle'):
        with open('token.pickle', 'rb') as token:
            creds = pickle.load(token)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server(port=0)
        # Save the credentials for the next run
        with open('token.pickle', 'wb') as token:
            pickle.dump(creds, token)

    service = build('gmailpostmastertools', 'v1beta1', credentials=creds)

    domains = service.domains().list().execute()
    if not domains:
        print('No domains found.')
    else:
        print('Domains:')
        for domain in domains['domains']:
            print(domain)

if __name__ == '__main__':
  main()
샘플 실행
작업 디렉터리에서 샘플을 빌드하고 실행합니다.
python3 quickstart.py
샘플을 처음 실행하면 액세스 권한을 승인하라는 메시지가 표시됩니다.
아직 Google 계정에 로그인하지 않았다면 메시지가 표시될 때 로그인합니다. 여러 계정에 로그인되어 있는 경우 승인에 사용할 계정을 하나 선택합니다.
수락을 클릭합니다.
Python 애플리케이션이 실행되고 Postmaster Tools API를 호출합니다.
승인 정보는 파일 시스템에 저장되므로 다음에 샘플 코드를 실행할 때는 승인 메시지가 표시되지 않습니다.
다음 단계
인증 및 승인 문제 해결 [https://developers.google.com/drive/activity/v2/troubleshoot-authentication-authorization?hl=ko]
Postmaster Tools API REST 참조 문서 [https://developers.google.com/workspace/gmail/postmaster/reference/rest?hl=ko]
Python용 Google API 클라이언트 문서 [https://developers.google.com/api-client-library/python?hl=ko]
Postmaster Tools API PyDoc 문서 [http://googleapis.github.io/google-api-python-client/docs/dyn/gmailpostmastertools_v1beta1.html]
도움이 되었나요?
의견 보내기